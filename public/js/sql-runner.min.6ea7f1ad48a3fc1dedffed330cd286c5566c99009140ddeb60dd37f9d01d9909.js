(function(){const d="Run SQL",f="Loading…",h="Running…",p="Result",a=!0,v=!0,n=700,r="(no rows)",_="(db initialized)",u=[".admonition.code code.language-sql","div.highlight div.chroma table code.language-sql","div.highlight div.chroma pre code.language-sql"].join(",");let t=null,e="idle";function i(){return`<span class="pm-run-spinner" aria-hidden="true"></span>`}function m(){return`<svg class="admon-icon" xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 640 512" width="16" height="16" fill="currentColor" aria-hidden="true">
        <path d="M392.8 1.2c-17-4.9-34.7 5-39.6 22l-128 448c-4.9 17 5 34.7 22 39.6s34.7-5 39.6-22l128-448c4.9-17-5-34.7-22-39.6zm80.6 120.1c-12.5 12.5-12.5 32.8 0 45.3L562.7 256l-89.4 89.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l112-112c12.5-12.5 12.5-32.8 0-45.3l-112-112c-12.5-12.5-32.8-12.5-45.3 0zm-306.7 0c-12.5-12.5-32.8-12.5-45.3 0l-112 112c-12.5 12.5-12.5 32.8 0 45.3l112 112c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l89.4-89.4c12.5-12.5 12.5-32.8 0-45.3z"></path>
        </svg>`}function s(){return t||(e="loading",t=(async()=>{if(!window.initSqlJs){const e=document.createElement("script");e.src="https://sql.js.org/dist/sql-wasm.js",document.head.appendChild(e),await new Promise(t=>e.onload=t)}const e=await initSqlJs({locateFile:e=>`https://sql.js.org/dist/${e}`});return new e.Database})().then(t=>(e="ready",t)).catch(t=>{throw e="idle",console.error("[sql-runner] load failed",t),alert("SQL engine load failed: "+t),t}),t)}function o(e){return e.closest(".admonition.code")}function g(e){const n=o(e);if(!n)return l(e.closest(".highlight")||e.parentElement,null);const t=n.nextElementSibling;return t&&t.classList.contains("admonition")&&t.classList.contains("code")&&t.classList.contains("sql-run-result")?t:l(n,n)}function l(e,t){const n=document.createElement("div");n.className="admonition code sql-run-result";let s="";if(t){const e=t.querySelector(".admonition-header svg");e&&(s=e.outerHTML)}s||(s=m());const o=document.createElement("div");o.className="admonition-header",o.innerHTML=`${s}<span>${p}</span>`;const i=document.createElement("div");i.className="admonition-content";const a=document.createElement("pre");return a.className="sql-run-stdout",i.appendChild(a),n.appendChild(o),n.appendChild(i),e.insertAdjacentElement("afterend",n),n}function b(e){return e.length?e.map(e=>{const t=e.columns.join("	"),n=e.values.map(e=>e.join("	")).join(`
`);return t+`
`+n}).join(`

`):r}function j(e){const t=e.textContent.trim().split(`
`);if(!t.length||t.length<1||t[0].indexOf("	")===-1)return;const n=document.createElement("table");n.className="sql-run-table";const s=n.insertRow();t[0].split("	").forEach(e=>{const t=document.createElement("th");t.textContent=e,s.appendChild(t)}),t.slice(1).forEach(e=>{const t=n.insertRow();e.split("	").forEach(e=>{const n=document.createElement("td");n.textContent=e,t.appendChild(n)})}),e.parentNode.replaceChild(n,e)}function y(t){if(t.dataset.sqlRunnerAttached==="1")return;t.dataset.sqlRunnerAttached="1";const p=o(t),u=v&&p?p.querySelector(".admonition-header"):null,m=t.closest(".highlight"),c=document.createElement("button");c.className="pm-run-btn sql-run-btn",c.type="button",c.dataset.state="idle",c.innerHTML=d;function l(e){switch(c.dataset.state=e,e){case"idle":case"done":case"error":c.disabled=!1,c.innerHTML=d;break;case"loading":c.disabled=!0,c.innerHTML=(a?i():"")+f;break;case"running":c.disabled=!0,c.innerHTML=(a?i():"")+h;break}}if(c.addEventListener("click",async()=>{const i=t.innerText,a=g(t);let o=a.querySelector("pre.sql-run-stdout"),c=!1;if(e==="idle"){l("loading");try{await s()}catch{l("error");return}}else e==="loading"&&(l("loading"),await s().catch(()=>{l("error")}));if(e!=="ready"){o.textContent="DB not ready";return}l("running");const d=await s();try{const t=i.split(/;[\r\n]+/).map(e=>e.trim()).filter(Boolean);let e=null;if(!t.length){o.textContent=r,l("done"),setTimeout(()=>l("idle"),n);return}for(const s of t)try{e=d.exec(s)}catch(e){o.textContent="SQL Error: "+e,l("error"),setTimeout(()=>l("idle"),n);return}!e||!e.length?o.textContent=_:(o.textContent=b(e),j(o),c=!0),l("done")}catch(e){o.textContent="Runtime Error: "+e,l("error")}finally{setTimeout(()=>l("idle"),n)}}),u){const e=u.querySelector("span");e?e.insertAdjacentElement("afterend",c):u.appendChild(c)}else if(m){const e=m.querySelector("button.copy-code");e?e.insertAdjacentElement("beforebegin",c):m.insertAdjacentElement("afterend",c)}else t.parentElement.insertAdjacentElement("afterend",c)}function c(){document.querySelectorAll(u).forEach(y)}window.addEventListener("load",c),new MutationObserver(e=>{e.some(e=>e.addedNodes&&e.addedNodes.length)&&c()}).observe(document.documentElement,{childList:!0,subtree:!0})})()